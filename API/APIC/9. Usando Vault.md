# Asegurando los Secretos

Durante el desarrollo del workshop hemos visto como crear Client Id y Client Secret, hemos visto como conectarnos por la API a la base de datos... pero tambien, hemos visto como dejar esas credenciales en archivos php o html. 

Claramente no es una buena practica, dejarlos con tan simple acceso. Por eso, vamos a hacer uso de Hashicorp Vault que es una boveda para guardar secretos.

En Vault vamos a generar estos secretos y vamos a consultarlos, cuando se requiera.

Para poder agregar este contenido, vamos a estar agregando una maquina virtual para poder instalar Hashicorp Vault.

---

Desplegar Vault
=


```bash
#!/bin/bash
# Instala y configura HashiCorp Vault (Open Source) en RHEL 9 (VM4)

# Instalar dependencias
sudo dnf install -y unzip curl jq

# Descargar Vault
VAULT_VERSION="1.15.2"
curl -O https://releases.hashicorp.com/vault/${VAULT_VERSION}/vault_${VAULT_VERSION}_linux_amd64.zip
unzip vault_${VAULT_VERSION}_linux_amd64.zip
sudo mv vault /usr/local/bin/

# Crear usuario y carpeta de datos
sudo useradd --system --home /etc/vault.d --shell /bin/false vault
sudo mkdir -p /etc/vault.d /var/lib/vault
sudo chown -R vault:vault /etc/vault.d /var/lib/vault

# Crear archivo de configuraci√≥n
cat <<EOF | sudo tee /etc/vault.d/vault.hcl
listener "tcp" {
  address     = "0.0.0.0:8200"
  tls_disable = 1
}

storage "file" {
  path = "/var/lib/vault"
}

ui = true
EOF

# Crear servicio systemd
cat <<EOF | sudo tee /etc/systemd/system/vault.service
[Unit]
Description=Vault Service
After=network.target

[Service]
User=vault
Group=vault
ExecStart=/usr/local/bin/vault server -config=/etc/vault.d/vault.hcl
ExecReload=/bin/kill -HUP $MAINPID
Restart=on-failure
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
EOF

# Habilitar y arrancar
sudo systemctl daemon-reexec
sudo systemctl enable vault
sudo systemctl start vault


```

---

