# Crear y Usar una API Simple con MySQL y Java desde una P√°gina Web en Apache

Este documento describe paso a paso c√≥mo crear y usar una API simple que se comunica con una base de datos MySQL, dividida en dos m√°quinas virtuales:

* **M√°quina 1:** Web server con Apache que aloja una p√°gina HTML.
* **M√°quina 2:** API REST construida en Java (Spring Boot) que consulta datos en una base de datos MySQL local.

---

## üñ•Ô∏è Arquitectura General

```
[Usuario] ‚Üí [M√°quina 1: Apache con HTML/JS] ‚Üí [M√°quina 2: API Java (Spring Boot) + MySQL]
```

---

## üõ†Ô∏è M√°quina 2: API REST en Java con MySQL

### 1. Instalar MySQL

```bash
sudo dnf install mariadb-server -y
sudo systemctl enable --now mariadb
sudo mysql_secure_installation
```

### 2. Crear Base de Datos y Tabla

```bash
mysql -u root -p
```

```sql
CREATE DATABASE clientes_db;
USE clientes_db;

CREATE TABLE clientes (
  IdCliente INT PRIMARY KEY,
  Nombre VARCHAR(100),
  Direccion VARCHAR(255),
  Correo VARCHAR(100)
);

INSERT INTO clientes VALUES (1, 'Juan P√©rez', 'Calle Falsa 123', 'juan@example.com');
INSERT INTO clientes VALUES (2, 'Mar√≠a G√≥mez', 'Av. Siempre Viva 456', 'maria@example.com');
```

### 3. Crear la API REST en Java (Spring Boot)

#### a) Dependencias en `pom.xml`

```xml
<dependencies>
  <dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
  </dependency>
  <dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
  </dependency>
  <dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <scope>runtime</scope>
  </dependency>
</dependencies>
```

#### b) Configuraci√≥n `application.properties`

```properties
spring.datasource.url=jdbc:mysql://localhost:3306/clientes_db
spring.datasource.username=root
spring.datasource.password=
spring.jpa.hibernate.ddl-auto=none
```

#### c) Modelo y Repositorio

```java
@Entity
public class Cliente {
  @Id
  private Integer idCliente;
  private String nombre;
  private String direccion;
  private String correo;
  // Getters y Setters
}

@Repository
public interface ClienteRepository extends JpaRepository<Cliente, Integer> {}
```

#### d) Controlador REST

```java
@RestController
@RequestMapping("/api/clientes")
public class ClienteController {

  @Autowired
  private ClienteRepository repo;

  @GetMapping("/{id}")
  public ResponseEntity<?> getCliente(@PathVariable Integer id) {
    return repo.findById(id)
        .map(ResponseEntity::ok)
        .orElse(ResponseEntity.status(404).body("Cliente no encontrado"));
  }
}
```

---

## üåê M√°quina 1: Servidor Web con Apache

### 1. Instalar Apache

```bash
sudo dnf install httpd -y
sudo systemctl enable --now httpd
```

### 2. Crear la P√°gina HTML

Guardar en: `/var/www/html/index.html`

```html
<!DOCTYPE html>
<html>
<head>
  <title>Buscar Cliente</title>
  <script>
    async function buscarCliente() {
      const id = document.getElementById("idCliente").value;
      const response = await fetch(`http://<IP_API>:8080/api/clientes/${id}`);
      const data = await response.json();
      document.getElementById("resultado").innerHTML =
        data.idCliente ?
        `Nombre: ${data.nombre}<br>Direcci√≥n: ${data.direccion}<br>Correo: ${data.correo}` :
        data;
    }
  </script>
</head>
<body>
  <h1>Consulta de Cliente</h1>
  <input type="number" id="idCliente" placeholder="Ingrese ID del cliente">
  <button onclick="buscarCliente()">Buscar</button>
  <div id="resultado"></div>
</body>
</html>
```

---

## üîÑ Flujo de Funcionamiento

1. El usuario accede a `http://<IP_WEB>/index.html`
2. Ingresa el ID de un cliente
3. La p√°gina consulta `http://<IP_API>:8080/api/clientes/{id}`
4. La API en Java consulta MySQL y devuelve un JSON
5. La p√°gina muestra los datos recibidos

---

## ‚úÖ Resultado Final

Una aplicaci√≥n web distribuida en dos m√°quinas:

* Una sirve la interfaz al usuario
* Otra contiene la l√≥gica de negocio en una API Java conectada a una base de datos MySQL

Ideal para pr√°cticas de arquitectura distribuida, seguridad y separaci√≥n de responsabilidades.
