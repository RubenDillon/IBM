On Premises Deployment
=

In this document we will discuss how to deploy Concert on Premises. We will be using one of the deployment models and the easiest way to do that.

For this activity we will need a virtual machine with the following reqs

- 16 vCPU
- 32 GB RAM
- at least 512 GB vDisk
- Linux Operating System (we will be using RHEL 9.2)

xxxy

Prepare the environment
-

1. Validate that the machine have at least free 512 GB, if it not do the following steps to extend your partition ...

If your are using LVM...

```
sudo su

yum install lvm2

df -h

vgdisplay

vgextend sysvg /dev/vdc

vgdisplay

lvextend -l +100%FREE  /dev/mapper/sysvg-lv_var

xfs_growfs /dev/mapper/sysvg-lv_var

df -h

```

If you are not using LVM... and you have for example /dev/vda with devices where /dev/vda4 is "/" and /dev/vdd is another disk (500 GB vDisk)


```
# 1. Crear el sistema de archivos en /dev/vdd
sudo mkfs.xfs /dev/vdd

# 2. Crear punto de montaje temporal
sudo mkdir /mnt/tempvar

# 3. Montar /dev/vdd temporalmente
sudo mount /dev/vdd /mnt/tempvar

# 4. Copiar los datos actuales de /var
sudo rsync -avx /var/ /mnt/tempvar/

# 5. Renombrar la carpeta original y crear una nueva vacía
sudo mv /var /var.backup
sudo mkdir /var

# 6. Montar el nuevo disco en /var
sudo mount /dev/vdd /var

# 7. Verificar que todo esté bien copiado
ls /var
# (deberías ver el contenido original de /var)

# 8. Obtener el UUID del nuevo disco
sudo blkid /dev/vdd
# (copiá el UUID que aparece, lo usarás en el siguiente paso)

# 9. Editar /etc/fstab para que el montaje sea permanente
sudo nano /etc/fstab
# Agregá al final:
# UUID=TU-UUID-AQUI   /var   xfs   defaults   0 0

# 10. Probar que el montaje funcione
sudo umount /var
sudo mount -a
df -h

# 11. Si todo funciona bien, eliminar el respaldo
sudo rm -rf /var.backup



```

   
3. configure the VM to support podman (Podman currently is the prefered container for RHEL OS)


4. Install git client and validate that wget is available   



Concert pre reqs 
-

1. Download the latest package of the Concert software, using the latest available version number. This package is also available on the Concert GitHub repository. Currently 1.10.0 is the latest version (https://github.com/IBM/Concert/releases)


```
wget https://github.com/IBM/Concert/releases/download/v1.1.0/ibm-concert-std.tgz
```
 
2. Expand the ibm-concert-std.tgz package in the chosen directory with at least 512 GB of available disk space. Replace <install_directory> with the local file path.

```
cd <install_directory> 
tar xfz ibm-concert-std.tgz
```

3. Setup environment variables

```
export DOCKER_EXE=podman
export CONCERT_REGISTRY=cp.icr.io/cp/concert

```

4. Set the username of the container registry
```
export CONCERT_REGISTRY_USER=cp
```

5. Set your Entitlement Key as the password
```
export CONCERT_REGISTRY_PASSWORD=<IBM Entitlement Key>
```

6. 

Documentation used for this activity
-

- https://www.ibm.com/docs/en/concert?topic=vm-installing-concert-software
- https://access.redhat.com/solutions/543593
